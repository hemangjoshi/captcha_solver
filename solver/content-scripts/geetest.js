var geetest=function(){"use strict";function yt(e){return e}const Ee={equals:(e,t)=>e===t};let Ue=Ae;const X=1,Q=2;var Z=null;let de=null,Ne=null,p=null,S=null,L=null,ee=0;function Se(e,t){t=t?Object.assign({},Ee,t):Ee;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),ke(n,r));return[Be.bind(n),s]}function De(e){if(p===null)return e();const t=p;p=null;try{return e()}finally{p=t}}function Be(){if(this.sources&&this.state)if(this.state===X)Ie(this);else{const e=S;S=null,te(()=>ne(this)),S=e}if(p){const e=this.observers?this.observers.length:0;p.sources?(p.sources.push(this),p.sourceSlots.push(e)):(p.sources=[this],p.sourceSlots=[e]),this.observers?(this.observers.push(p),this.observerSlots.push(p.sources.length-1)):(this.observers=[p],this.observerSlots=[p.sources.length-1])}return this.value}function ke(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&te(()=>{for(let r=0;r<e.observers.length;r+=1){const o=e.observers[r],i=de&&de.running;i&&de.disposed.has(o),(i?!o.tState:!o.state)&&(o.pure?S.push(o):L.push(o),o.observers&&_e(o)),i||(o.state=X)}if(S.length>1e6)throw S=[],new Error})),t}function Ie(e){if(!e.fn)return;se(e);const t=ee;Me(e,e.value,t)}function Me(e,t,n){let s;const r=Z,o=p;p=Z=e;try{s=e.fn(t)}catch(i){return e.pure&&(e.state=X,e.owned&&e.owned.forEach(se),e.owned=null),e.updatedAt=n+1,Ce(i)}finally{p=o,Z=r}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?ke(e,s):e.value=s,e.updatedAt=n)}function Te(e){if(e.state===0)return;if(e.state===Q)return ne(e);if(e.suspense&&De(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ee);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===X)Ie(e);else if(e.state===Q){const s=S;S=null,te(()=>ne(e,t[0])),S=s}}function te(e,t){if(S)return e();let n=!1;S=[],L?n=!0:L=[],ee++;try{const s=e();return Ye(n),s}catch(s){n||(L=null),S=null,Ce(s)}}function Ye(e){if(S&&(Ae(S),S=null),e)return;const t=L;L=null,t.length&&te(()=>Ue(t))}function Ae(e){for(let t=0;t<e.length;t++)Te(e[t])}function ne(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const r=s.state;r===X?s!==t&&(!s.updatedAt||s.updatedAt<ee)&&Te(s):r===Q&&ne(s,t)}}}function _e(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Q,n.pure?S.push(n):L.push(n),n.observers&&_e(n))}}function se(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const o=r.pop(),i=n.observerSlots.pop();s<r.length&&(o.sourceSlots[i]=s,r[s]=o,n.observerSlots[s]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)se(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)se(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Xe(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ce(e,t=Z){throw Xe(e)}const Ve="0.1.7",je=(e,t)=>{const n=document.createElement("div");n.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",n.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(n),(()=>{const o=document.getElementById("countdown");if(!o)return;let i=t;const k=setInterval(()=>{i--,o.textContent=i,i<=0&&clearInterval(k)},1e3)})();const r=document.createElement("style");r.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(r),setTimeout(()=>{n.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(n)},1e3)},t*1e3)},N=e=>document.querySelector(e),qe=e=>document.querySelectorAll(e);function xe(){return N(".task-answers")!==null}function Oe(){return qe(".task-image .image").length===9}function Pe(){return N(".bounding-box-example")!==null}function Ge(){return N(".challenge-header")!==null&&N(".bounding-box-example")===null&&N(".task-grid")==null}function We(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function D(e){return new Promise(t=>setTimeout(t,e))}function Ke(e,t){return Math.floor(Math.random()*(t-e)+e)}function He(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function ze(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await Je(t)}async function Je(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.addEventListener("loadend",()=>{const s=n.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),n.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function $e(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const n=await t.blob();return new Promise((s,r)=>{const o=new FileReader;o.readAsDataURL(n),o.addEventListener("loadend",()=>{s(o.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),o.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),r("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function Qe(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function Ze(){Pe()?(await D(200),document.querySelector(".display-language.button").click(),await D(100),document.querySelector(".language-selector .option:nth-child(23)").click()):Oe()?(await D(100),document.querySelector(".language-selector .option:nth-child(23)").click()):xe()&&(document.querySelector(".display-language.button").click(),await D(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await D(200))}function et(){document.querySelector(".button-submit").click()}async function tt(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):n[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{version:n,platform:navigator.platform})}function nt(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function fe(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const n=document.createEvent("MouseEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)}})}function he(e,t,n,s,r,o,i){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:n,clientY:s,buttons:r,button:o,pressure:i}))}async function st(e,t){const n=document.querySelector("canvas");if(e!==void 0)for(const{start:s,end:r}of e)if(Array.isArray(s)&&s.length!==0&&Array.isArray(r)&&r.length!==0){const[o,i]=s,[k,w]=r,g=n.getBoundingClientRect(),T=o+g.left,b=i+g.top,C=k+g.left,v=w+g.top;he(n,"mousedown",T,b,1,0,1),await new Promise($=>setTimeout($,t));const q=C-T,A=v-b,R=Math.sqrt(q**2+A**2),O=Math.round(R/6),U=q/O,V=A/O;for(let $=1;$<=O;$++){const we=T+U*$,ae=b+V*$;he(n,"mousemove",we,ae,1,0,1),await new Promise(B=>setTimeout(B,50))}he(n,"mouseup",C,v,0,0,0)}else a.$(".button-submit").click();else a.$(".button-submit").click()}async function rt(e){function t(o,i,k){const w=o.getBoundingClientRect(),g=["mouseover","mousedown","mouseup","click"],T={clientX:i+w.left,clientY:k+w.top,bubbles:!0};for(let b=0;b<g.length;b++){const C=new MouseEvent(g[b],T);o.dispatchEvent(C)}}const n=document.querySelector("canvas");n.addEventListener("mousedown",o=>{const i=n.getBoundingClientRect();o.clientX-i.left,o.clientY-i.top});const[s,r]=e;t(n,s,r),await a.sleep(300)}async function ot(e,t){const n=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${n}/${e}`:"https://api.captchasonic.com/createTask"}async function it(e){for(const t of e){const n=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);fe(n),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||fe(n)}}async function at(){const e=document.querySelector("canvas");if(!e)return null;const[t,n]=[e.width,e.height],r=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,n,{willReadFrequently:!0});if((v=>{const q=v.data;for(let A=0;A<q.length;A+=4){const R=q[A],O=q[A+1],U=q[A+2];if(R!==O||O!==U)return!1}return!0})(r))return null;const i=parseInt(e.style.width,10),k=parseInt(e.style.height,10);if(i<=0||k<=0)return null;const w=Math.min(i/t,k/n),[g,T]=[t*w,n*w],b=document.createElement("canvas");return Object.assign(b,{width:g,height:T}),b.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,n,0,0,g,T),b.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function ct(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function lt(e){return Promise.all(e.map(async(t,n)=>(e[n]=await $e(t),e[n])))}async function ut(e,t,n){const s=e.getBoundingClientRect(),r=s.left+window.scrollX,o=s.top+window.scrollY,i=r+t,k=o+n,w=new MouseEvent("mousedown",{clientX:r,clientY:o,bubbles:!0});e.dispatchEvent(w),await new Promise(v=>setTimeout(v,1e3));const g=20,T=(i-r)/g,b=(k-o)/g;for(let v=1;v<=g;v++){const q=r+T*v,A=o+b*v,R=new MouseEvent("mousemove",{clientX:q,clientY:A,bubbles:!0});e.dispatchEvent(R),await new Promise(O=>setTimeout(O,150))}const C=new MouseEvent("mouseup",{clientX:i,clientY:k,bubbles:!0});e.dispatchEvent(C),await new Promise(v=>setTimeout(v,1e3))}async function gt(e,t,n){try{const r=await(await fetch(e,{method:"POST",headers:n,body:JSON.stringify(t)})).json();if(r.code!==200){const o=r.msg;if(o){if(r.code===1||r.code===10||r.code===18||r.code===110){chrome.runtime.sendMessage({action:o}),stop=!0;return}if(r.code===17||r.code===19||r.code===429){chrome.runtime.sendMessage({action:o}),stop=!0;return}if([4,3,12,13,14,115].includes(r.code))return document.querySelector(".geetest_refresh").click(),null}}return r}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function dt(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();return console.log("Success:",n),n}catch(t){return console.error("Error sending feedback:",t),null}}const a={version:Ve,$:N,$$:qe,isMulti:xe,isGrid:Oe,isBbox:Pe,isBboxDD:Ge,isWidget:We,sleep:D,randTimer:Ke,isSolved:He,countdownNotif:je,getBase64FromUrl:$e,refreshIframes:Qe,getEn:Ze,skip:et,getBrowser:tt,shuffle:nt,fireMouseEvents:fe,getCanvas:rt,handleCanvasDD:st,getApi:ot,clickMatchingElement:it,sliceOG:at,updateExamples:lt,getExamples:ct,solveGeetestCaptcha:ut,sendCoordinatesRequest:gt,geeFetchImage:ze,sendFeedback:dt};async function ft(e,t,n){if(!e()||e().ACTIVE===!1||e().OPTIONS[n].ENABLED===!1)return!1;function s(i,k){try{return k.includes(i)}catch(w){return console.error("Error parsing URLs:",w),!1}}const r=e().BLACKLIST;return!(s(t(),r)&&e().BLACKLISTENABLED)}const ht={matches:["<all_urls>"],allFrames:!0,match_about_blank:!1,async main(){const[e]=Se(window.location.host),[t,n]=Se(await chrome.storage.local.get("settings"));n(t().settings),await ft(t,e,"GEETEST")&&(async()=>{let o,i=!1;const k={"Content-Type":"application/json"};let w=null,g=null;const T=()=>!navigator.onLine||t().APIKEY===void 0||t().APIKEY===""||t().ACTIVE===!1||t().OPTIONS.GEETEST.ENABLED===!1;let b,C;if(window.geetestInjected)return;for(window.geetestInjected=!0;!T();){await a.sleep(1e3);let c=a.$$(".geetest_btn_click"),l=c[c.length-1];l&&t().OPTIONS.GEETEST.AUTOOPEN===!0&&t()?.AUTOOPENENABLED===!0&&l.click(),await a.sleep(2e3);let u=null,d=null,m=null,h=null,y=null;const _=a.$$(".geetest_wrap");if(_.length>0){const f=_[_.length-1];u=f.querySelector("div.geetest_subitem.geetest_slide"),d=f.querySelector("div.geetest_subitem.geetest_click"),m=_[_.length-1].querySelector("div.geetest_subitem.geetest_match"),h=f.querySelector("div.geetest_subitem.geetest_winlinze"),y=f.querySelector(".geetest_subitem.geetest_nine")}u?g="geetest_slide":d?g="geetest_click":m?g="geetest_match":h?g="geetest_winlinze":y&&(g="geetest_nine");const ce=document.querySelector(".geetest_text_tips");if(ce&&(w=ce.textContent.trim()),u&&t()?.OPTIONS?.GEETEST?.AUTOSOLVE===!0&&await v()){const f=a.$$("div.geetest_bg"),I=f[f.length-1],x=U(I.style.backgroundImage),P=a.$$("div.geetest_slice_bg"),M=P[P.length-1],j=U(M.style.backgroundImage);x&&j?(b=await a.geeFetchImage(x),C=await a.geeFetchImage(j)):console.error("One or both image URLs are missing.");const G=a.$$("div.geetest_box_wrap"),le=G[G.length-1];if(le&&le.style.display==="block"){if(!b||!C){console.error("Base64 images are missing or invalid.");return}const ue={apiKey:t().APIKEY,source:"chrome",version:a.version,appID:0,task:{type:"GeetestImage",queries:[b],examples:[C],question:`${g}:${w}`,websiteURL:e()}};let Y;try{Y=await V(ue)}catch(F){console.error("Failed to retrieve coordinates:",F)}const W=a.$$("div.geetest_slice_bg"),K=W[W.length-1];K&&Y!=null&&(await a.solveGeetestCaptcha(K,Y.answers[0],Y.answers[1]),o=(o-Date.now())/1e3,await a.sleep(1e3),i=await B(".geetest_tip","Verification Success"))}}else if(d&&t()?.OPTIONS?.GEETEST?.AUTOSOLVE===!0&&await v()){if(!d)return;try{const f=await O(),I=await V(f);if(I)if(I.answers)await $(I.answers,300),await we(),await ae();else{let x=document.querySelectorAll(".geetest_refresh");x[x.length-1].click()}}catch(f){console.log("Captcha processing failed:",f)}}else if(m)document.querySelectorAll('div[class*="geetest_item_"]').forEach(I=>{Array.from(I.classList).find(P=>P.startsWith("geetest_item_")).split("_").pop()}),await a.sleep(3e3),i=await B(".geetest_tip","Verification Success");else if(h){const f=document.querySelectorAll(".geetest_itemimg"),I=[];f.forEach(x=>{const P=x.style.backgroundImage;if(P){const M=P.match(/img_winlinze_(\d+)\.png/);M?I.push(parseInt(M[1],10)):I.push(0)}else I.push(0)}),await a.sleep(2e3),await a.sleep(3e3),i=await B(".geetest_tip","Verification Success")}else if(y&&t()?.OPTIONS?.GEETEST?.AUTOSOLVE===!0&&await v())try{const f=await q(),I=await A();if(!f||f.length===0||!I)throw new Error("Failed to retrieve image URLs or question image URL.");const x=await a.geeFetchImage(f[0]),P=await a.geeFetchImage(I);if(!x||!P)throw new Error("Failed to fetch images in base64 format.");const M=async(E,be=3,ue=3)=>new Promise((Y,W)=>{const K="data:image/jpeg;base64,";E.startsWith("data:image")||(E=K+E);const F=new Image;F.src=E,F.onload=()=>{try{const H=F.width,bt=F.height,z=H/ue,J=bt/be,ge=document.createElement("canvas"),Le=ge.getContext("2d"),Re=[];for(let ve=0;ve<be;ve++)for(let ye=0;ye<ue;ye++){ge.width=z,ge.height=J,Le.clearRect(0,0,z,J),Le.drawImage(F,ye*z,ve*J,z,J,0,0,z,J);const vt=ge.toDataURL("image/jpeg").replace(K,"");Re.push(vt)}Y(Re)}catch(H){W("Error slicing image: "+H.message)}},F.onerror=H=>W("Error loading image: "+H.message)});let j=[];try{j=await M(x)}catch(E){console.error("Failed to slice base64 image:",E);return}const G=t().APIKEY;if(!G)throw new Error("API key is missing. Please configure the API key.");const le={apiKey:G,source:"chrome",version:a.version,appID:0,task:{type:"GeetestImage",queries:j,examples:[P],question:`${g}:${w}`,websiteURL:e()}};try{const E=await V(le);(!E||!E.answers)&&console.error("Invalid response received:",E),await a.sleep(2e3),await R(E.answers),o=(o-Date.now())/1e3,await ae()}catch(E){console.error("An error occurred:",E)}try{await B(".geetest_tip","Verification Success")?console.log("Verification succeeded."):console.warn("Verification failed. Please retry.")}catch(E){console.error("Error checking verification message:",E)}}catch(f){console.error("Error processing geetestNine:",f)}}async function v(){return!!document.querySelector(".geetest_freeze_wait")}async function q(){const c=document.querySelectorAll("div.geetest_imgs0.geetest_item_img");let l=[],u=c[c.length-1].getAttribute("style");const d=u?u.match(/url\("([^"]+)"\)/):null;return d&&l.push(d[1]),l}async function A(){const c=document.querySelectorAll("div.geetest_ques_tips.geetest_ques_back");if(c){const l=c[c.length-1].querySelector("img");return l?l.src:null}return null}async function R(c){const l=Array.from(document.querySelectorAll(".geetest_item")).slice(-9);for(let u=0;u<c.length;u++)if(c[u]&&l[u]){const m=l[u].querySelectorAll(`.geetest_ghost_${u}`);m?(m[m.length-1].click(),await a.sleep(300)):console.log(`No element found for .geetest_ghost_${u}`)}}async function O(){const c={apiKey:t().APIKEY,source:"chrome",version:a.version,appID:0,task:{type:"GeetestImage",queries:[],examples:[],question:`${g}:${w}`,websiteURL:e()}},l=document.querySelectorAll("div.geetest_bg"),u=l[l.length-1];if(u){const h=U(u.style.backgroundImage),y=await a.geeFetchImage(h);c.task.queries.push(y)}else console.warn("Background div not found.");const d=document.querySelectorAll(".geetest_ques_tips.geetest_ques_back"),m=d[d.length-1];if(m){const h=Array.from(m.querySelectorAll("img")).slice(-3),y=await Promise.all(h.map(_=>a.geeFetchImage(_.src)));c.task.examples=y}else console.warn("Image container not found.");return c}function U(c){const l=c.match(/"([^"]*)"/);return l?l[1]:null}async function V(c){return o=Date.now(),new Promise((l,u)=>{try{const d={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:k,body:JSON.stringify(c)}};chrome.runtime.sendMessage(d,async m=>{if(m.success){const h=m.data;if(h.code!==200){const y=h.msg;if(y){if(h.code===1||h.code===10||h.code===18||m.code===110){chrome.runtime.sendMessage({action:y}),i=!0;return}if(h.code===17||h.code===19||h.code===429){chrome.runtime.sendMessage({action:y}),i=!0;return}if([4,3,12,13,14,115].includes(h.code)){let _=document.querySelectorAll(".geetest_refresh");return _[_.length-1].click(),l(null)}}}else if(h.code===200)return l(h)}else console.error("Error for Request 2:",m.error)})}catch(d){return console.error("Error fetching coordinates:",d),u(d)}})}async function $(c,l){const u=a.$$(".geetest_bg"),d=u[u.length-1];if(!d)return;const m=d.getBoundingClientRect();for(const h of c)if(h.length>0)for(const y of h){const _=m.left+y.x,ce=m.top+y.y;await a.sleep(300);const f=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,clientX:_,clientY:ce});d.dispatchEvent(f),await a.sleep(l)}else{let y=document.querySelectorAll(".geetest_refresh");y[y.length-1].click()}}async function we(){const c=a.$$(".geetest_submit"),l=c[c.length-1];l&&l.click()}async function ae(){await a.sleep(2e3);const c=a.$$(".geetest_result_tips"),l=c[c.length-1];l&&l.textContent.trim().length>0&&(i=!0)}async function B(c,l,u=3e3){const d=a.$(c);return!!(d&&d.textContent.trim()===l)}})()}},Fe=globalThis.browser?.runtime?.id==null?globalThis.chrome:globalThis.browser;function re(e,...t){}const mt={debug:(...e)=>re(console.debug,...e),log:(...e)=>re(console.log,...e),warn:(...e)=>re(console.warn,...e),error:(...e)=>re(console.error,...e)};class me extends Event{constructor(t,n){super(me.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}static EVENT_NAME=pe("wxt:locationchange")}function pe(e){return`${Fe?.runtime?.id}:geetest:${e}`}function pt(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new me(s,n)),n=s)},1e3))}}}class oe{constructor(t,n){this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=pe("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=pt(this);get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return Fe.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const s=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,n){const s=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const n=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const s=requestIdleCallback((...r)=>{this.signal.aborted||t(...r)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,n,s,r){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(n.startsWith("wxt:")?pe(n):n,s,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),mt.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:oe.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")}listenForNewerScripts(t){let n=!0;const s=r=>{if(r.data?.type===oe.SCRIPT_STARTED_MESSAGE_TYPE&&r.data?.contentScriptName===this.contentScriptName){const o=n;if(n=!1,o&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}function St(){}function ie(e,...t){}const wt={debug:(...e)=>ie(console.debug,...e),log:(...e)=>ie(console.log,...e),warn:(...e)=>ie(console.warn,...e),error:(...e)=>ie(console.error,...e)};return(async()=>{try{const{main:e,...t}=ht,n=new oe("geetest",t);return await e(n)}catch(e){throw wt.error('The content script "geetest" crashed on startup!',e),e}})()}();
geetest;
