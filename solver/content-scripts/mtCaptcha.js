var mtcaptcha=function(){"use strict";function Ge(e){return e}const Z={equals:(e,t)=>e===t};let he=re;const R=1,N=2;var $=null;let _=null,me=null,f=null,h=null,M=null,D=0;function ee(e,t){t=t?Object.assign({},Z,t):Z;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),te(n,r));return[ge.bind(n),s]}function pe(e){if(f===null)return e();const t=f;f=null;try{return e()}finally{f=t}}function ge(){if(this.sources&&this.state)if(this.state===R)ne(this);else{const e=h;h=null,X(()=>Y(this)),h=e}if(f){const e=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(e)):(f.sources=[this],f.sourceSlots=[e]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function te(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&X(()=>{for(let r=0;r<e.observers.length;r+=1){const o=e.observers[r],a=_&&_.running;a&&_.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?h.push(o):M.push(o),o.observers&&oe(o)),a||(o.state=R)}if(h.length>1e6)throw h=[],new Error})),t}function ne(e){if(!e.fn)return;j(e);const t=D;we(e,e.value,t)}function we(e,t,n){let s;const r=$,o=f;f=$=e;try{s=e.fn(t)}catch(a){return e.pure&&(e.state=R,e.owned&&e.owned.forEach(j),e.owned=null),e.updatedAt=n+1,ie(a)}finally{f=o,$=r}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?te(e,s):e.value=s,e.updatedAt=n)}function se(e){if(e.state===0)return;if(e.state===N)return Y(e);if(e.suspense&&pe(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<D);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===R)ne(e);else if(e.state===N){const s=h;h=null,X(()=>Y(e,t[0])),h=s}}function X(e,t){if(h)return e();let n=!1;h=[],M?n=!0:M=[],D++;try{const s=e();return be(n),s}catch(s){n||(M=null),h=null,ie(s)}}function be(e){if(h&&(re(h),h=null),e)return;const t=M;M=null,t.length&&X(()=>he(t))}function re(e){for(let t=0;t<e.length;t++)se(e[t])}function Y(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const r=s.state;r===R?s!==t&&(!s.updatedAt||s.updatedAt<D)&&se(s):r===N&&Y(s,t)}}}function oe(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=N,n.pure?h.push(n):M.push(n),n.observers&&oe(n))}}function j(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const o=r.pop(),a=n.observerSlots.pop();s<r.length&&(o.sourceSlots[a]=s,r[s]=o,n.observerSlots[s]=a)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)j(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)j(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function ve(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ie(e,t=$){throw ve(e)}const Ee="0.1.7",ye=(e,t)=>{const n=document.createElement("div");n.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",n.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(n),(()=>{const o=document.getElementById("countdown");if(!o)return;let a=t;const b=setInterval(()=>{a--,o.textContent=a,a<=0&&clearInterval(b)},1e3)})();const r=document.createElement("style");r.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(r),setTimeout(()=>{n.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(n)},1e3)},t*1e3)},O=e=>document.querySelector(e),ae=e=>document.querySelectorAll(e);function ce(){return O(".task-answers")!==null}function le(){return ae(".task-image .image").length===9}function ue(){return O(".bounding-box-example")!==null}function Se(){return O(".challenge-header")!==null&&O(".bounding-box-example")===null&&O(".task-grid")==null}function Te(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function F(e){return new Promise(t=>setTimeout(t,e))}function Ce(e,t){return Math.floor(Math.random()*(t-e)+e)}function ke(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function Ae(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await xe(t)}async function xe(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.addEventListener("loadend",()=>{const s=n.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(s)}),n.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function de(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const n=await t.blob();return new Promise((s,r)=>{const o=new FileReader;o.readAsDataURL(n),o.addEventListener("loadend",()=>{s(o.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),o.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),r("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function Ie(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function Me(){ue()?(await F(200),document.querySelector(".display-language.button").click(),await F(100),document.querySelector(".language-selector .option:nth-child(23)").click()):le()?(await F(100),document.querySelector(".language-selector .option:nth-child(23)").click()):ce()&&(document.querySelector(".display-language.button").click(),await F(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await F(200))}function qe(){document.querySelector(".button-submit").click()}async function Oe(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):n[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{version:n,platform:navigator.platform})}function Fe(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function W(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const n=document.createEvent("MouseEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)}})}function G(e,t,n,s,r,o,a){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:n,clientY:s,buttons:r,button:o,pressure:a}))}async function Le(e,t){const n=document.querySelector("canvas");if(e!==void 0)for(const{start:s,end:r}of e)if(Array.isArray(s)&&s.length!==0&&Array.isArray(r)&&r.length!==0){const[o,a]=s,[b,d]=r,m=n.getBoundingClientRect(),v=o+m.left,p=a+m.top,y=b+m.left,g=d+m.top;G(n,"mousedown",v,p,1,0,1),await new Promise(x=>setTimeout(x,t));const S=y-v,E=g-p,q=Math.sqrt(S**2+E**2),C=Math.round(q/6),P=S/C,z=E/C;for(let x=1;x<=C;x++){const Q=v+P*x,I=p+z*x;G(n,"mousemove",Q,I,1,0,1),await new Promise(i=>setTimeout(i,50))}G(n,"mouseup",y,g,0,0,0)}else A.$(".button-submit").click();else A.$(".button-submit").click()}async function Re(e){function t(o,a,b){const d=o.getBoundingClientRect(),m=["mouseover","mousedown","mouseup","click"],v={clientX:a+d.left,clientY:b+d.top,bubbles:!0};for(let p=0;p<m.length;p++){const y=new MouseEvent(m[p],v);o.dispatchEvent(y)}}const n=document.querySelector("canvas");n.addEventListener("mousedown",o=>{const a=n.getBoundingClientRect();o.clientX-a.left,o.clientY-a.top});const[s,r]=e;t(n,s,r),await A.sleep(300)}async function Pe(e,t){const n=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${n}/${e}`:"https://api.captchasonic.com/createTask"}async function Ue(e){for(const t of e){const n=[...document.querySelectorAll(".answer-text")].find(s=>s.outerText===t);W(n),[...document.querySelectorAll(".answer-example")].some(s=>s.style.backgroundColor==="rgb(116, 116, 116)")||W(n)}}async function Ne(){const e=document.querySelector("canvas");if(!e)return null;const[t,n]=[e.width,e.height],r=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,n,{willReadFrequently:!0});if((g=>{const S=g.data;for(let E=0;E<S.length;E+=4){const q=S[E],C=S[E+1],P=S[E+2];if(q!==C||C!==P)return!1}return!0})(r))return null;const a=parseInt(e.style.width,10),b=parseInt(e.style.height,10);if(a<=0||b<=0)return null;const d=Math.min(a/t,b/n),[m,v]=[t*d,n*d],p=document.createElement("canvas");return Object.assign(p,{width:m,height:v}),p.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,n,0,0,m,v),p.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function $e(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function De(e){return Promise.all(e.map(async(t,n)=>(e[n]=await de(t),e[n])))}async function Xe(e,t,n){const s=e.getBoundingClientRect(),r=s.left+window.scrollX,o=s.top+window.scrollY,a=r+t,b=o+n,d=new MouseEvent("mousedown",{clientX:r,clientY:o,bubbles:!0});e.dispatchEvent(d),await new Promise(g=>setTimeout(g,1e3));const m=20,v=(a-r)/m,p=(b-o)/m;for(let g=1;g<=m;g++){const S=r+v*g,E=o+p*g,q=new MouseEvent("mousemove",{clientX:S,clientY:E,bubbles:!0});e.dispatchEvent(q),await new Promise(C=>setTimeout(C,150))}const y=new MouseEvent("mouseup",{clientX:a,clientY:b,bubbles:!0});e.dispatchEvent(y),await new Promise(g=>setTimeout(g,1e3))}async function Ye(e,t,n){try{const r=await(await fetch(e,{method:"POST",headers:n,body:JSON.stringify(t)})).json();if(r.code!==200){const o=r.msg;if(o){if(r.code===1||r.code===10||r.code===18||r.code===110){chrome.runtime.sendMessage({action:o}),stop=!0;return}if(r.code===17||r.code===19||r.code===429){chrome.runtime.sendMessage({action:o}),stop=!0;return}if([4,3,12,13,14,115].includes(r.code))return document.querySelector(".geetest_refresh").click(),null}}return r}catch(s){throw console.error("Error fetching coordinates:",s),s}}async function je(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();return console.log("Success:",n),n}catch(t){return console.error("Error sending feedback:",t),null}}const A={version:Ee,$:O,$$:ae,isMulti:ce,isGrid:le,isBbox:ue,isBboxDD:Se,isWidget:Te,sleep:F,randTimer:Ce,isSolved:ke,countdownNotif:ye,getBase64FromUrl:de,refreshIframes:Ie,getEn:Me,skip:qe,getBrowser:Oe,shuffle:Fe,fireMouseEvents:W,getCanvas:Re,handleCanvasDD:Le,getApi:Pe,clickMatchingElement:Ue,sliceOG:Ne,updateExamples:De,getExamples:$e,solveGeetestCaptcha:Xe,sendCoordinatesRequest:Ye,geeFetchImage:Ae,sendFeedback:je},Be={matches:["<all_urls>"],allFrames:!0,async main(){const[e]=ee(window.location.href),[t,n]=ee(await chrome.storage.local.get("settings"));n(t().settings);let s=null,r=[],o=null,a=!1,b=0,d=!1,m="OcrImage",v="mtcaptcha",p=0,y=null;const g=document.createElement("script");if(g.src=chrome.runtime.getURL("themes/mt.js"),(document.head||document.documentElement).appendChild(g),window.messageListenerAdded)return;window.messageListenerAdded=!0,window.addEventListener("message",async i=>{try{if(i.data&&i.data.data){let l;try{l=JSON.parse(i.data.data)}catch{return}if(l.code===1200){const u=l.result?.challenge?.textChlg?.textlen;u&&(p=u,a=!0)}}}catch(l){console.error("Unexpected error in message listener:",l)}});function S(i){return new Promise(l=>setTimeout(l,i))}async function E(){if(!d){d=!0;try{t().OPTIONS.MTCAPTCHA.METHOD=="RECOGNITION"?await C():t().OPTIONS.MTCAPTCHA.METHOD=="audio"&&await P()}catch(i){console.log("Error in solving captcha: ",i)}finally{s=null,r=[],o=null}}}async function q(i,l,u,k,T,w){const U={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:i,task:{type:u,websiteURL:l,queries:k,module:T,maxLength:w}})}};chrome.runtime.sendMessage(U,async c=>{if(c.success){if(c=c.data,c.code!==200){const L=c.msg;if(L){if(c.code===1||c.code===10||c.code===18||c.code===110){chrome.runtime.sendMessage({action:L}),d=!0;return}if(c.code===17||c.code===19||c.code===429){chrome.runtime.sendMessage({action:L}),d=!0;return}[4,3,12,13,14,115].includes(c.code)&&I()}}else if(c.code===200)if(o=document.querySelector("#mtcap-inputtext-1"),c?.answers)try{b=c?.answers[0].length,z(o),await x(o,c?.answers[0])}catch{chrome.runtime.sendMessage({action:"no solutions"})}else{I();return}}else console.error("Error for Request 2:",c.error)})}async function C(){let i=document.querySelector("#mtcap-image-1");if(i){const u=i.getAttribute("style").match(/url\((.*?)\)/);if(u&&u[1]){const k=u[1].replace(/['"]/g,"");y!==k&&(y=k,r.push(await A.getBase64FromUrl(k)))}}if(o=document.querySelector("#mtcap-inputtext-1"),!i||!o){I();return}if(r.length===0){I();return}await q(t().APIKEY,e(),m,r,v,p)}async function P(){if(s=document.querySelector("audio"),o=document.querySelector("#mtcap-inputtext-1"),!s||!o){I();return}}function z(i){if(i&&typeof i.dispatchEvent=="function"){const l=new FocusEvent("focus",{bubbles:!0,cancelable:!0});i.dispatchEvent(l);const u=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0,buttons:1});i.dispatchEvent(u);const k=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0,buttons:0});i.dispatchEvent(k);for(const T of["mouseover","mousedown","mouseup","click"]){const w=new MouseEvent(T,{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(w)}}else console.log("Invalid element or dispatchEvent is not available.")}async function x(i,l){function u(T,w,U){const c=new w(U);T.dispatchEvent(c)}function k(T){["mouseover","mousedown","mouseup","click"].forEach(w=>{u(T,MouseEvent,{bubbles:!0,cancelable:!0,view:window,type:w})})}k(i),u(i,FocusEvent,{bubbles:!0,cancelable:!0,type:"focus"});for(let T=0;T<l.length;T++){const w=l[T];if(await A.sleep(500),Math.random()<.05){const We=String.fromCharCode(Math.floor(Math.random()*26)+97);i.value+=We,i.dispatchEvent(new Event("input",{bubbles:!0})),await A.sleep(Math.random()*200+50),i.value=i.value.slice(0,-1),i.dispatchEvent(new Event("input",{bubbles:!0}))}const U=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,view:window,key:w,code:`Key${w.toUpperCase()}`,location:0}),c=new KeyboardEvent("keypress",{bubbles:!0,cancelable:!0,view:window,key:w,code:`Key${w.toUpperCase()}`,location:0}),L=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,view:window,key:w,code:`Key${w.toUpperCase()}`,location:0});i.dispatchEvent(U),i.dispatchEvent(c),i.value+=w,i.dispatchEvent(new Event("input",{bubbles:!0})),i.dispatchEvent(L)}u(i,FocusEvent,{bubbles:!0,cancelable:!0,type:"blur"}),await Q()}async function Q(){await A.sleep(5e3);let i=document.querySelector(".mtcap-image");if(i){const u=i.getAttribute("style").match(/url\((.*?)\)/);if(u&&u[1])if(u[1].replace(/['"]/g,"")===y)I();else{d=!1;return}}else console.log("not fouond image element")}async function I(){return await A.sleep(2e3),d=!1,document.querySelector("#mtcap-statusbutton-1")?.click()}for(;t().ACTIVE===!0&&!t().BLACKLIST.includes(e());)if(await S(3e3),t().OPTIONS.MTCAPTCHA.AUTOSOLVE&&d!==!0){let i=document.querySelector("#desc4InputText-1"),l="";i&&(l=i.textContent),l!=="captcha verified successfully."&&d!==!0&&await E()}}},fe=globalThis.browser?.runtime?.id==null?globalThis.chrome:globalThis.browser;function B(e,...t){}const He={debug:(...e)=>B(console.debug,...e),log:(...e)=>B(console.log,...e),warn:(...e)=>B(console.warn,...e),error:(...e)=>B(console.error,...e)};class K extends Event{constructor(t,n){super(K.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}static EVENT_NAME=J("wxt:locationchange")}function J(e){return`${fe?.runtime?.id}:mtCaptcha:${e}`}function Ve(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new K(s,n)),n=s)},1e3))}}}class H{constructor(t,n){this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=J("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Ve(this);get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return fe.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const s=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(t,n){const s=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(t){const n=requestAnimationFrame((...s)=>{this.isValid&&t(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const s=requestIdleCallback((...r)=>{this.signal.aborted||t(...r)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(t,n,s,r){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(n.startsWith("wxt:")?J(n):n,s,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),He.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:H.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")}listenForNewerScripts(t){let n=!0;const s=r=>{if(r.data?.type===H.SCRIPT_STARTED_MESSAGE_TYPE&&r.data?.contentScriptName===this.contentScriptName){const o=n;if(n=!1,o&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}}function Je(){}function V(e,...t){}const _e={debug:(...e)=>V(console.debug,...e),log:(...e)=>V(console.log,...e),warn:(...e)=>V(console.warn,...e),error:(...e)=>V(console.error,...e)};return(async()=>{try{const{main:e,...t}=Be,n=new H("mtCaptcha",t);return await e(n)}catch(e){throw _e.error('The content script "mtCaptcha" crashed on startup!',e),e}})()}();
mtcaptcha;
