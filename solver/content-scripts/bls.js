var bls=function(){"use strict";function Ve(e){return e}const G={equals:(e,t)=>e===t};let ae=Z;const L=1,F=2;var R=null;let V=null,le=null,m=null,E=null,C=null,M=0;function H(e,t){t=t?Object.assign({},G,t):G;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),z(n,s));return[de.bind(n),r]}function ue(e){if(m===null)return e();const t=m;m=null;try{return e()}finally{m=t}}function de(){if(this.sources&&this.state)if(this.state===L)J(this);else{const e=E;E=null,N(()=>B(this)),E=e}if(m){const e=this.observers?this.observers.length:0;m.sources?(m.sources.push(this),m.sourceSlots.push(e)):(m.sources=[this],m.sourceSlots=[e]),this.observers?(this.observers.push(m),this.observerSlots.push(m.sources.length-1)):(this.observers=[m],this.observerSlots=[m.sources.length-1])}return this.value}function z(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&N(()=>{for(let s=0;s<e.observers.length;s+=1){const o=e.observers[s],i=V&&V.running;i&&V.disposed.has(o),(i?!o.tState:!o.state)&&(o.pure?E.push(o):C.push(o),o.observers&&ee(o)),i||(o.state=L)}if(E.length>1e6)throw E=[],new Error})),t}function J(e){if(!e.fn)return;Y(e);const t=M;fe(e,e.value,t)}function fe(e,t,n){let r;const s=R,o=m;m=R=e;try{r=e.fn(t)}catch(i){return e.pure&&(e.state=L,e.owned&&e.owned.forEach(Y),e.owned=null),e.updatedAt=n+1,te(i)}finally{m=o,R=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?z(e,r):e.value=r,e.updatedAt=n)}function Q(e){if(e.state===0)return;if(e.state===F)return B(e);if(e.suspense&&ue(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<M);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===L)J(e);else if(e.state===F){const r=E;E=null,N(()=>B(e,t[0])),E=r}}function N(e,t){if(E)return e();let n=!1;E=[],C?n=!0:C=[],M++;try{const r=e();return he(n),r}catch(r){n||(C=null),E=null,te(r)}}function he(e){if(E&&(Z(E),E=null),e)return;const t=C;C=null,t.length&&N(()=>ae(t))}function Z(e){for(let t=0;t<e.length;t++)Q(e[t])}function B(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===L?r!==t&&(!r.updatedAt||r.updatedAt<M)&&Q(r):s===F&&B(r,t)}}}function ee(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=F,n.pure?E.push(n):C.push(n),n.observers&&ee(n))}}function Y(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const o=s.pop(),i=n.observerSlots.pop();r<s.length&&(o.sourceSlots[i]=r,s[r]=o,n.observerSlots[r]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Y(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Y(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function me(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function te(e,t=R){throw me(e)}async function pe(e,t,n){if(!e()||e().ACTIVE===!1||e().OPTIONS[n].ENABLED===!1)return!1;function r(i,S){try{return S.includes(i)}catch(f){return console.error("Error parsing URLs:",f),!1}}const s=e().BLACKLIST;return!(r(t(),s)&&e().BLACKLISTENABLED)}const ge="0.1.7",we=(e,t)=>{const n=document.createElement("div");n.style.cssText="position:fixed;top:8%;left:0;background-color:rgba(0,0,0,.6);padding:2px;color:#fff;font:calc(14px + .5vw) 'Arial',sans-serif;font-weight:bold;text-transform:uppercase;letter-spacing:1px;z-index:9999;transition:all 1s;animation:slideIn 1s forwards",n.innerHTML=`<p>${e}. Retrying in..<span id="countdown">${t}</span></p>`,document.body.appendChild(n),(()=>{const o=document.getElementById("countdown");if(!o)return;let i=t;const S=setInterval(()=>{i--,o.textContent=i,i<=0&&clearInterval(S)},1e3)})();const s=document.createElement("style");s.innerHTML="@keyframes slideIn{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}@keyframes slideOut{0%{transform:translateX(0)}100%{transform:translateX(100%)}}",document.head.appendChild(s),setTimeout(()=>{n.style.animation="slideOut 1s forwards",setTimeout(()=>{document.body.removeChild(n)},1e3)},t*1e3)},q=e=>document.querySelector(e),ne=e=>document.querySelectorAll(e);function re(){return q(".task-answers")!==null}function se(){return ne(".task-image .image").length===9}function oe(){return q(".bounding-box-example")!==null}function be(){return q(".challenge-header")!==null&&q(".bounding-box-example")===null&&q(".task-grid")==null}function ve(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:document.querySelector("div.check")!==null}function P(e){return new Promise(t=>setTimeout(t,e))}function Ee(e,t){return Math.floor(Math.random()*(t-e)+e)}function ye(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}async function Se(e){const t=await(await fetch(e,{headers:{"if-none-match":'"CFDAD5AA0CE4A3068FF1CABAC59E4D9D"'},host:"https://domain.com"})).blob();return await Te(t)}async function Te(e){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.addEventListener("loadend",()=>{const r=n.result.replace(/^data:image\/(png|jpeg);base64,/,"");t(r)}),n.addEventListener("error",()=>{logs&&console.log("❌ Failed to convert url to base64")})})}async function ie(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch the URL: ${e}`);const n=await t.blob();return new Promise((r,s)=>{const o=new FileReader;o.readAsDataURL(n),o.addEventListener("loadend",()=>{r(o.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),o.addEventListener("error",()=>{console.error("❌ Failed to read blob as base64"),s("Failed to read blob")})})}catch(t){return console.error(`❌ Failed to convert URL to base64: ${e}`,t),null}}function Ae(){document.querySelectorAll("iframe").forEach(t=>{t.src=t.src})}async function ke(){oe()?(await P(200),document.querySelector(".display-language.button").click(),await P(100),document.querySelector(".language-selector .option:nth-child(23)").click()):se()?(await P(100),document.querySelector(".language-selector .option:nth-child(23)").click()):re()&&(document.querySelector(".display-language.button").click(),await P(200),document.querySelector(".language-selector .option:nth-child(23)").click(),await P(200))}function Ce(){document.querySelector(".button-submit").click()}async function Ie(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],`IE ${t[1]||""}`):n[1]==="Chrome"&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=e.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{version:n,platform:navigator.platform})}function xe(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function j(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const n=document.createEvent("MouseEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)}})}function _(e,t,n,r,s,o,i){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,clientX:n,clientY:r,buttons:s,button:o,pressure:i}))}async function qe(e,t){const n=document.querySelector("canvas");if(e!==void 0)for(const{start:r,end:s}of e)if(Array.isArray(r)&&r.length!==0&&Array.isArray(s)&&s.length!==0){const[o,i]=r,[S,f]=s,p=n.getBoundingClientRect(),A=o+p.left,h=i+p.top,g=S+p.left,T=f+p.top;_(n,"mousedown",A,h,1,0,1),await new Promise(a=>setTimeout(a,t));const k=g-A,y=T-h,I=Math.sqrt(k**2+y**2),c=Math.round(I/6),u=k/c,w=y/c;for(let a=1;a<=c;a++){const d=A+u*a,l=h+w*a;_(n,"mousemove",d,l,1,0,1),await new Promise(b=>setTimeout(b,50))}_(n,"mouseup",g,T,0,0,0)}else U.$(".button-submit").click();else U.$(".button-submit").click()}async function Pe(e){function t(o,i,S){const f=o.getBoundingClientRect(),p=["mouseover","mousedown","mouseup","click"],A={clientX:i+f.left,clientY:S+f.top,bubbles:!0};for(let h=0;h<p.length;h++){const g=new MouseEvent(p[h],A);o.dispatchEvent(g)}}const n=document.querySelector("canvas");n.addEventListener("mousedown",o=>{const i=n.getBoundingClientRect();o.clientX-i.left,o.clientY-i.top});const[r,s]=e;t(n,r,s),await U.sleep(300)}async function Oe(e,t){const n=(await chrome.storage.local.get("customEndpoint")).customEndpoint;return t==="custom"?`https://${n}/${e}`:"https://api.captchasonic.com/createTask"}async function Le(e){for(const t of e){const n=[...document.querySelectorAll(".answer-text")].find(r=>r.outerText===t);j(n),[...document.querySelectorAll(".answer-example")].some(r=>r.style.backgroundColor==="rgb(116, 116, 116)")||j(n)}}async function Fe(){const e=document.querySelector("canvas");if(!e)return null;const[t,n]=[e.width,e.height],s=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,t,n,{willReadFrequently:!0});if((T=>{const k=T.data;for(let y=0;y<k.length;y+=4){const I=k[y],c=k[y+1],u=k[y+2];if(I!==c||c!==u)return!1}return!0})(s))return null;const i=parseInt(e.style.width,10),S=parseInt(e.style.height,10);if(i<=0||S<=0)return null;const f=Math.min(i/t,S/n),[p,A]=[t*f,n*f],h=document.createElement("canvas");return Object.assign(h,{width:p,height:A}),h.getContext("2d",{willReadFrequently:!0}).drawImage(e,0,0,t,n,0,0,p,A),h.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/,"")}function Re(e){return[...document.querySelectorAll(`${e}`)].map(t=>t.style.backgroundImage.replace(/url\("|"\)/g,""))}function Me(e){return Promise.all(e.map(async(t,n)=>(e[n]=await ie(t),e[n])))}async function Ne(e,t,n){const r=e.getBoundingClientRect(),s=r.left+window.scrollX,o=r.top+window.scrollY,i=s+t,S=o+n,f=new MouseEvent("mousedown",{clientX:s,clientY:o,bubbles:!0});e.dispatchEvent(f),await new Promise(T=>setTimeout(T,1e3));const p=20,A=(i-s)/p,h=(S-o)/p;for(let T=1;T<=p;T++){const k=s+A*T,y=o+h*T,I=new MouseEvent("mousemove",{clientX:k,clientY:y,bubbles:!0});e.dispatchEvent(I),await new Promise(c=>setTimeout(c,150))}const g=new MouseEvent("mouseup",{clientX:i,clientY:S,bubbles:!0});e.dispatchEvent(g),await new Promise(T=>setTimeout(T,1e3))}async function Be(e,t,n){try{const s=await(await fetch(e,{method:"POST",headers:n,body:JSON.stringify(t)})).json();if(s.code!==200){const o=s.msg;if(o){if(s.code===1||s.code===10||s.code===18||s.code===110){chrome.runtime.sendMessage({action:o}),stop=!0;return}if(s.code===17||s.code===19||s.code===429){chrome.runtime.sendMessage({action:o}),stop=!0;return}if([4,3,12,13,14,115].includes(s.code))return document.querySelector(".geetest_refresh").click(),null}}return s}catch(r){throw console.error("Error fetching coordinates:",r),r}}async function Ye(e){try{const t=await fetch("https://feedback.captchasonic.com/extFeedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();return console.log("Success:",n),n}catch(t){return console.error("Error sending feedback:",t),null}}const U={version:ge,$:q,$$:ne,isMulti:re,isGrid:se,isBbox:oe,isBboxDD:be,isWidget:ve,sleep:P,randTimer:Ee,isSolved:ye,countdownNotif:we,getBase64FromUrl:ie,refreshIframes:Ae,getEn:ke,skip:Ce,getBrowser:Ie,shuffle:xe,fireMouseEvents:j,getCanvas:Pe,handleCanvasDD:qe,getApi:Oe,clickMatchingElement:Le,sliceOG:Fe,updateExamples:Me,getExamples:Re,solveGeetestCaptcha:Ne,sendCoordinatesRequest:Be,geeFetchImage:Se,sendFeedback:Ye},Ue={matches:["<all_urls>"],allFrames:!0,async main(){const[e]=H(window.location.host),[t,n]=H(await chrome.storage.local.get("settings"));if(n(t().settings),!await pe(t,e,"BLS"))return;let o=!1,i=!1;t().APIKEY;const S=()=>!navigator.onLine||i||t().APIKEY===void 0||t().APIKEY==="";let f=await A();const p=document.createElement("script");for(p.src=chrome.runtime.getURL("themes/bls.js"),(document.head||document.documentElement).appendChild(p);o===!1&&t()?.AUTOOPENENABLED&&!f.BLACKLIST.includes(e)&&!S();)if(await h(2e3),o===!1){o=!0;try{const c=document.querySelector("#btnVerify");c&&f.OPTIONS.BLS.AUTOOPEN===!0&&c.click(),await h(500),f.OPTIONS.BLS.AUTOSOLVE===!0&&(await I(),h(1e3))}catch{o=!1}}async function A(){return new Promise((c,u)=>{chrome.storage.local.get(["settings"],w=>{chrome.runtime.lastError?u(chrome.runtime.lastError.message):c(w.settings)})})}function h(c){return new Promise(u=>setTimeout(u,c))}function g(c,u){const w=[...document.querySelectorAll(".col-4")].filter(l=>l.getClientRects().length);let a=0,d=null;for(let l=0;l<w.length;l++){const b=document.defaultView.getComputedStyle(w[l],null),v=b.getPropertyValue("left"),x=b.getPropertyValue("top"),O=b.getPropertyValue("z-index");v==c+"px"&&x==u+"px"&&O>a&&O!="auto"&&(a=O,d=w[l])}return d}function T(){const c=[...document.querySelectorAll(".box-label")];let u=0,w=null;for(let a=0;a<c.length;a++){const d=document.defaultView.getComputedStyle(c[a],null).getPropertyValue("z-index");d>u&&d!=="auto"&&(u=d,w=c[a].innerText.replace(/\D/g,""))}return w}async function k(c,u="createTask",w="POST"){return new Promise((a,d)=>{const l={type:"networkRequest",payload:{url:"https://api.captchasonic.com/createTask",method:"POST",headers:{"Content-Type":"application/json",apikey:f.APIKEY,appid:0},body:JSON.stringify(c)}};chrome.runtime.sendMessage(l,b=>{if(!b)return d(new Error("No response received from chrome.runtime.sendMessage."));if(b.success){const v=b.data;if(v.code!==200){const x=v.msg;if(x){if(v.code===1||v.code===10||v.code===18||b.code===110){chrome.runtime.sendMessage({action:x}),i=!0;return}if(v.code===17||v.code===19||v.code===429){chrome.runtime.sendMessage({action:x}),i=!0;return}if([4,3,12,13,14,115].includes(v.code)){const O=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(3)");O&&y(O)}}}a(v)}else d("Error for Request on bls:",b.error),console.error("Error for Request on bls:",b.error)})})}async function y(c,u={}){const w=["mouseover","mousedown","mouseup","click"];u.bubbles=!0,w.forEach(a=>{const d=new MouseEvent(a,u);c.dispatchEvent(d)})}async function I(){const c=[g(0,0),g(110,0),g(220,0),g(0,110),g(110,110),g(220,110),g(0,220),g(110,220),g(220,220)],u=T(),w=[];await h(1e3),Array.from(c).forEach((a,d)=>{const l=a?.querySelector("img");l&&(w.push(l.src.replace(/^data:image\/(png|jpeg|gif);base64,/,"")),l.src)}),f.APIKEY!=""&&Object.keys(w).length!=0&&(async()=>{try{const a=await k({apiKey:t().APIKEY,source:"extension",version:U.version,appID:0,task:{type:"OcrImage",queries:w,numeric:!0,module:"bls",case:!1,maxLength:3}});if(a){const d=a.answers;if(Array.isArray(d)){d.forEach((b,v)=>{const x=c[v].querySelector("img");b===u&&y(x)});const l=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(3)");l&&y(l)}else{Object.keys(d).forEach(b=>{const v=c[b].querySelector("img");v&&d[b]===u&&y(v)});const l=document.querySelector("#captchaForm > div.text-center.row.no-gutters.img-actions.p-2 > div:nth-child(3)");l&&y(l)}}}catch(a){console.log("error fetching bls data",a)}})()}}},ce=globalThis.browser?.runtime?.id==null?globalThis.chrome:globalThis.browser;function D(e,...t){}const De={debug:(...e)=>D(console.debug,...e),log:(...e)=>D(console.log,...e),warn:(...e)=>D(console.warn,...e),error:(...e)=>D(console.error,...e)};class K extends Event{constructor(t,n){super(K.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}static EVENT_NAME=W("wxt:locationchange")}function W(e){return`${ce?.runtime?.id}:bls:${e}`}function Xe(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let r=new URL(location.href);r.href!==n.href&&(window.dispatchEvent(new K(r,n)),n=r)},1e3))}}}class X{constructor(t,n){this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=W("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Xe(this);get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return ce.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const r=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(t,n){const r=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(t){const n=requestAnimationFrame((...r)=>{this.isValid&&t(...r)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const r=requestIdleCallback((...s)=>{this.signal.aborted||t(...s)},n);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(t,n,r,s){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(n.startsWith("wxt:")?W(n):n,r,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),De.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:X.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")}listenForNewerScripts(t){let n=!0;const r=s=>{if(s.data?.type===X.SCRIPT_STARTED_MESSAGE_TYPE&&s.data?.contentScriptName===this.contentScriptName){const o=n;if(n=!1,o&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}}function _e(){}function $(e,...t){}const $e={debug:(...e)=>$(console.debug,...e),log:(...e)=>$(console.log,...e),warn:(...e)=>$(console.warn,...e),error:(...e)=>$(console.error,...e)};return(async()=>{try{const{main:e,...t}=Ue,n=new X("bls",t);return await e(n)}catch(e){throw $e.error('The content script "bls" crashed on startup!',e),e}})()}();
bls;
